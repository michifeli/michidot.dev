---
import MainLayout from "../../layouts/MainLayout.astro";
import Navigation from "../../components/Navigation.astro";
import Footer from "../../components/Footer.astro";

interface BlogPostModule {
  frontmatter: {
    title: string;
    description?: string;
    pubDate: string | Date;
  };
  url: string;
}

const posts = (await Astro.glob(
  "/src/pages/blog/posts/*.md"
)) as BlogPostModule[];

// ordenar del más nuevo al más antiguo
posts.sort(
  (a, b) =>
    new Date(b.frontmatter.pubDate).getTime() -
    new Date(a.frontmatter.pubDate).getTime()
);
---

<MainLayout>
  <div slot="header">
    <Navigation />
  </div>

  <main style="max-width:900px;margin:36px auto; padding:20px;">
    <h1>Blog</h1>
    <p class="muted">
      Bienvenido a mi blog donde comparto artículos sobre Linux, open source y
      tópicos variados de tecnología. Quizás encuentres algo interesante para
      ti; a veces también comparto algunos pensamientos personales. ¡Disfruta la
      lectura!.
    </p>

    <section class="blog-list" style="margin-top:20px">
      {
        posts.length === 0 ? (
          <p class="muted">No hay posts todavía.</p>
        ) : (
          posts.map((post) => (
            <article class="post-card card">
              <h2>
                <a href={post.url}>{post.frontmatter.title}</a>
              </h2>
              <div class="muted">{post.frontmatter.pubDate}</div>
              {post.frontmatter.description ? (
                <p class="muted" style="margin-top:8px">
                  {post.frontmatter.description}
                </p>
              ) : null}
            </article>
          ))
        )
      }
    </section>

    <p style="margin-top:24px" class="muted">
      Vuelve a el <a href="/">inicio</a>.
    </p>

    <div style="margin-top:36px">
      <Footer />
    </div>
  </main>
</MainLayout>
